{"version":3,"sources":["index.js"],"names":["API_KEY","URL_BASE","hideArticle","document","querySelector","remove","showArticle","title","publishedAt","source","url","urlToImage","content","parent","template","Math","round","Date","name","node","createElement","innerHTML","children","addEventListener","append","getTopArticles","preferredCategories","request","Request","method","fetch","then","response","json","data","articles","renderArticles","getElementById","storyTemplate","html","forEach","article","init","navigator","serviceWorker","register","registration","console","log","scope","catch","error","deferredPrompt","self","evt","preventDefault","style","display","prompt","userChoice","choice","ID1","setTimeout","window","Notification","requestPermission","result","clearTimeout","onLine","timeoutID"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["// variables and constants\nconst API_KEY = \"53347d537f0143dfb390e4a816c50efa\";\nconst URL_BASE = \"https://newsapi.org/v2\";\n\nconst hideArticle = () => {\n  document.querySelector(\".container-back\").remove();\n};\n// get a single article\nconst showArticle = ({\n  title,\n  publishedAt,\n  source,\n  url,\n  urlToImage,\n  content\n}) => {\n  const parent = document.querySelector(\".app-container\");\n  const template = `\n<div class=\"container-back\">\n        <div class=\"full-story-container\">\n          <button class=\"action-btn\">\n              <span>&#10005;</span>\n          </button>\n          <h4 class=\"story-title\">${title}</h4>\n\n          <div class=\"story-img\">\n            <img src=${urlToImage} alt=\"${title}\" />\n          </div>\n          <div class=\"story-content\">${content || \"content not available\"}</div>\n          <div class=\"story-desc\">\n              <div class=\"story-category\">life</div>\n              <div class=\"story-pub-date\">${Math.round(\n                (new Date() - new Date(publishedAt)) / 3600000\n              )} mins ago</div>\n              <div class=\"story-source\">from ${source.name}</div>\n          </div>\n        </div>\n      </div>\n`;\n  const node = document.createElement(\"template\");\n  node.innerHTML = template;\n  node.content.children[0].children[0].children[0].addEventListener(\n    \"click\",\n    () => {\n      hideArticle();\n    }\n  );\n  parent.append(node.content);\n};\n\n// get top articles\nconst getTopArticles = async (\n  preferredCategories = [\"entertainment\", \"business\", \"technology\"]\n) => {\n  const request = new Request(\n    `${URL_BASE}/top-headlines?country=us&category=${\n      preferredCategories[0]\n    }&apiKey=${API_KEY}`,\n    {\n      method: \"GET\"\n    }\n  );\n\n  return fetch(request)\n    .then(response => response.json())\n    .then(data => data.articles);\n};\n\nconst renderArticles = async () => {\n  const parent = document.getElementById(\"user-stories-group\");\n  const storyTemplate = ({ title, publishedAt, urlToImage }) => {\n    const html = `\n    <div class=\"story-container top-story\">\n              <div class=\"story-desc\">\n                <h4 class=\"story-title\">\n                  ${title}\n                </h4>\n                <div>\n                  <span class=\"story-category\">life</span>\n                  <span class=\"story-pub-date\">${Math.round(\n                    (new Date() - new Date(publishedAt)) / 3600000\n                  )} mins ago</span>\n                </div>\n              </div>\n              <div class=\"story-img\">\n                <img src=${urlToImage} alt=${title} />\n              </div>\n            </div>\n    `;\n    const template = document.createElement(\"template\");\n    template.innerHTML = html;\n    return template.content;\n  };\n\n  const articles = await getTopArticles();\n  articles.forEach(article => {\n    const node = storyTemplate(article);\n    node.children[0].addEventListener(\"click\", () => {\n      showArticle(article);\n    });\n    parent.append(node);\n  });\n};\n\n(async function init() {\n  // check if service worker API is supported\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker\n      .register(\"/serviceWorker.js\", {})\n      .then(registration => {\n        console.log(\n          `serviceWorker registered successfully with scope ${\n            registration.scope\n          }`\n        );\n      })\n      .catch(error => {\n        console.log(`ServiceWorker registration failed with error ${error}`);\n      });\n  }\n\n  // listen to beforeinstallprompt on window object to use a custom install banner for PWA\n  let deferredPrompt;\n  self.addEventListener(\"beforeinstallprompt\", evt => {\n    evt.preventDefault();\n    // Stash the event so it can be triggered later.\n    deferredPrompt = evt;\n    document.querySelector(\"#installBtn\").addEventListener(\"click\", () => {\n      document.querySelector(\"#installBanner\").style.display = \"none\";\n      deferredPrompt.prompt();\n      deferredPrompt.userChoice.then(choice => {\n        deferredPrompt = null;\n      });\n    });\n    document.querySelector(\"#cancel\").addEventListener(\"click\", () => {\n      document.querySelector(\"#installBanner\").style.display = \"none\";\n    });\n    document.querySelector(\"#installBanner\").style.display = \"block\";\n  });\n\n  //Request for notification permission\n  const ID1 = setTimeout(() => {\n    if (\"Notification\" in window) {\n      Notification.requestPermission().then(result => {\n        if ((result = \"denied\")) {\n          return;\n        }\n        if ((result = \"default\")) {\n          return;\n        }\n      });\n    }\n    clearTimeout(ID1);\n  }, 5000);\n\n  //send a push notification\n  // const ID2 = setTimeout(() => {\n  //   if (\"Notification\" in window && Notification.permission === \"granted\") {\n  //     // navigator.serviceWorker.getRegistration().then()\n  //     const notification = new Notification(\n  //       \"Welcome to the finest news in town!\"\n  //     );\n  //   }\n  //   clearTimeout(ID2);\n  // }, 10000);\n  // add event listeners for the offline and online events\n  // so that we can notify the user that the content is cached\n  if (navigator.onLine !== true) {\n    document.querySelector(\".toast\").style.display = \"block\";\n    setTimeout(() => {\n      document.querySelector(\".toast\").style.display = \"none\";\n    }, 5000);\n  }\n  self.addEventListener(\"offline\", () => {\n    document.querySelector(\".toast\").style.display = \"block\";\n    const timeoutID = setTimeout(() => {\n      document.querySelector(\".toast\").style.display = \"none\";\n      clearTimeout(timeoutID);\n    }, 5000);\n  });\n  await renderArticles();\n})();\n"]}